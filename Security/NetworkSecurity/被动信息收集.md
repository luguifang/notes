# 1、信息收集-DNS
## 1.1、域名解析原理
### 1.1.1、DNS服务器概述
        运行DNS服务器程序的计算机，储存 DNS 数据库信息。DNS服务器分为根域DNS服务器、顶级域名DNS服务器。
        根域DNS 服务器有13个，都存储了全部的顶级域名服务器的所在地址;顶级域名服务器存储了每位客户所注册的主机地址，
        这里对应到163.com.这个级别
### 1.1.2、域名记录:A，Cname，NS，MX，PTR
#### A记录(Address)正向解析
        A记录是将一个主机名（全称域名FQDN)和一个IP地址关联起来。这也是大多数客户端程序默认的查询类型。例: baidu.com-> 8.8.8.6
#### PTR记录(Pointer)反向解析
        PTR记录将一个IP地址对应到主机名，(全称域名FQDN)。这些记录保存在in-addr.arpa域中。
#### CNAME记录(Canonical Name)别名
        别名记录，也称为规范名字(Canonical Name)。这种记录允许您将多个名字映射到同一台计算机。例: www.xuegod.cn 对应IP8.8.8.6，web.xuegod.cn对应IP8.8.8.6
#### MX记录(Mail eXchange) 
        MX记录是邮件交换记录，它指向一个邮件服务器，用于电子邮件系统发邮件时根据收信人的地址后缀来定位邮件服务器。
        当有多个MX记录(即有多个邮件服务器）时，则需要设置数值来确定其优先级。通过设置优先级数字来指明首选服务器，数字越小表示优先级越高。
        例: mail.xuegod.cn
#### NS记录(Name Server) 
    NS (Name Server）记录是域名服务器记录，也称为授权服务器，用来指定该域名由哪个DNS 服务器来进行解析。

### 1.1.3、DNS 查询过程
        DNS 查询方式：递归查询和迭代查询
        一个dns 查询过程是通过8 个步骤的解析过程来使得客户端可以顺利访问news.163.com这个域名，但实际应用中，通常这个过程很迅速
    如图：
！[image](https://github.com/luguifang/notes/blob/main/Security/NetworkSecurity/image/1.jpg)

        * 浏览器缓存：当用户通过浏览器访问某个域名时，浏览器首先会在自己的缓存中查找是否有该域名对应的ip（若曾经访问过该域名且没有清空缓存则存在）
        * 系统缓存:当浏览器缓存中无域名对应IP则会自动检查用户计算机系统Hosts文件 DNS缓存是否有该域名对应的ip
        * 路由器缓存:当浏览器及系统缓存中均无域名对应IP则进入路由器缓存中检查，以上三步均为客户端的DNS缓存;
        * ISP(互联网服务提供商）DNS缓存(一般就是本地DNS服务器):当在用户客户端查找不到域名对应IP地址，则将进入ISP DNS缓存中进行查询。比如你用的是电信的网络，则会进入电信的DNS缓存服务器中进行查找
        * 根域名服务器:当以上均未完成，则进入根服务器进行查询。全球仅有13台根域名服务器，1个主根域名服务器，其余12为辅根域名服务器。根域名收到请求后会查看区域文件记录，若无则将其管辖范围内顶级域名(如.com)服务器IP告诉本地 DNS 服务器
        * 顶级域名服务器:顶级域名服务器收到请求后查看区域文件记录，若无则将其管辖范围内主域名服务器的IP地址告诉本地DNS 服务器;
        * 域名服务器:主域名服务器接受到请求后查询自己的缓存，如果没有则进入下一级域名服务器进行查找,并重复该步骤直至找到正确纪录;
        * 保存结果至缓存:本地域名服务器把返回的结果保存到缓存，以备下一次使用，同时将该结果反馈给客户端，客户端通过这个IP地址与web服务器建立链接
        
